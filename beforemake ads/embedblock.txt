<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مشغل البث المباشر</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #000;
        }

        .iframe-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000;
        }

        #stream {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }

        /* حجب شامل للإعلانات - أقصى صرامة */
        iframe[src*="ad"],
        iframe[src*="ads"],
        iframe[src*="doubleclick"],
        iframe[src*="googlesyndication"],
        iframe[src*="advertising"],
        iframe[src*="adservice"],
        iframe[src*="banner"],
        iframe[src*="popup"],
        iframe[id*="google_ads"],
        iframe[class*="ad-"],
        iframe[class*="ads-"],
        div[class*="ad-container"],
        div[class*="ads-container"],
        div[class*="advertisement"],
        div[id*="ad-"],
        div[id*="ads-"],
        div[id*="google_ads"],
        a[href*="/ads/"],
        a[href*="doubleclick"],
        img[src*="/ads/"],
        img[src*="banner"],
        .advertisement,
        .ad-banner,
        .ads,
        .sponsor,
        [class*="AdBlock"],
        [id*="AdBlock"],
        [class*="sponsor"],
        [id*="sponsor"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            width: 0 !important;
            height: 0 !important;
            position: absolute !important;
            left: -9999px !important;
            pointer-events: none !important;
        }

        /* حجب overlay ads */
        div[style*="position: absolute"],
        div[style*="position: fixed"] {
            pointer-events: none !important;
        }

        /* السماح فقط للـ iframe الرئيسي بالتفاعل */
        #stream {
            pointer-events: auto !important;
        }
    </style>
</head>
<body>
    <div class="iframe-container">
        <iframe 
            id="stream"
            src="https://pl.kooralive.fit/albaplayer/thmanya1/"
            allow="autoplay; fullscreen; encrypted-media; picture-in-picture; accelerometer; gyroscope"
            allowfullscreen
            sandbox="allow-scripts allow-same-origin allow-forms allow-presentation"
            referrerpolicy="no-referrer"
            scrolling="no"
            frameborder="0">
        </iframe>
    </div>

    <script>
        // منع جميع النوافذ المنبثقة
        window.open = function() { return null; };
        
        // منع window.alert و confirm و prompt
        window.alert = function() { return false; };
        window.confirm = function() { return false; };
        window.prompt = function() { return null; };

        // حجب جميع محاولات فتح نوافذ جديدة
        document.addEventListener('click', function(e) {
            if (e.target.tagName === 'A' && e.target.target === '_blank') {
                const href = e.target.href;
                if (href && (
                    href.includes('ad') || 
                    href.includes('ads') ||
                    href.includes('popup') ||
                    href.includes('sponsor') ||
                    href.includes('click') ||
                    href.includes('track')
                )) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    return false;
                }
            }
        }, true);

        // منع أي محاولة للتوجيه
        let preventRedirect = true;
        window.addEventListener('beforeunload', function(e) {
            if (preventRedirect) {
                e.preventDefault();
                e.returnValue = '';
            }
        });

        // مراقبة وحذف الإعلانات الديناميكية بشكل مستمر
        const adKeywords = [
            'ad', 'ads', 'adv', 'advertising', 'advertisement',
            'banner', 'popup', 'sponsor', 'promo', 'promotion',
            'doubleclick', 'googlesyndication', 'googleadservices',
            'adservice', 'adsystem', 'adserver', 'adtech'
        ];

        function removeAds() {
            // حذف جميع iframes المشبوهة
            document.querySelectorAll('iframe').forEach(frame => {
                if (frame.id !== 'stream') {
                    const src = frame.src.toLowerCase();
                    const id = (frame.id || '').toLowerCase();
                    const className = (frame.className || '').toLowerCase();
                    
                    for (let keyword of adKeywords) {
                        if (src.includes(keyword) || id.includes(keyword) || className.includes(keyword)) {
                            frame.remove();
                            break;
                        }
                    }
                }
            });

            // حذف جميع العناصر المشبوهة
            document.querySelectorAll('div, a, img, video').forEach(el => {
                const id = (el.id || '').toLowerCase();
                const className = (el.className || '').toLowerCase();
                
                for (let keyword of adKeywords) {
                    if (id.includes(keyword) || className.includes(keyword)) {
                        el.remove();
                        break;
                    }
                }
            });
        }

        // تشغيل حذف الإعلانات كل 500ms
        setInterval(removeAds, 500);

        // مراقبة DOM للتغييرات
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                mutation.addedNodes.forEach(function(node) {
                    if (node.nodeType === 1) {
                        const tagName = node.tagName;
                        const src = (node.src || '').toLowerCase();
                        const id = (node.id || '').toLowerCase();
                        const className = (node.className || '').toLowerCase();

                        // حذف فوري لأي عنصر مشبوه
                        for (let keyword of adKeywords) {
                            if (src.includes(keyword) || id.includes(keyword) || className.includes(keyword)) {
                                node.remove();
                                return;
                            }
                        }

                        // حذف iframes غير المشغل الرئيسي
                        if (tagName === 'IFRAME' && node.id !== 'stream') {
                            node.remove();
                        }
                    }
                });
            });
        });

        observer.observe(document.body, {
            childList: true,
            subtree: true,
            attributes: true,
            attributeFilter: ['src', 'href', 'class', 'id']
        });

        // حجب طلبات الإعلانات على مستوى الشبكة
        if ('serviceWorker' in navigator) {
            // تسجيل service worker لحجب الطلبات
            const swCode = `
                self.addEventListener('fetch', function(event) {
                    const url = event.request.url.toLowerCase();
                    const adPatterns = ['ad', 'ads', 'doubleclick', 'googlesyndication', 'banner', 'popup', 'sponsor'];
                    
                    for (let pattern of adPatterns) {
                        if (url.includes(pattern)) {
                            event.respondWith(new Response('', {status: 200}));
                            return;
                        }
                    }
                });
            `;
            
            const blob = new Blob([swCode], { type: 'application/javascript' });
            const swUrl = URL.createObjectURL(blob);
            
            navigator.serviceWorker.register(swUrl).catch(() => {
                // Service Worker غير مدعوم أو فشل التسجيل
            });
        }

        // منع التتبع
        if (navigator.doNotTrack !== '1') {
            Object.defineProperty(navigator, 'doNotTrack', {
                get: function() { return '1'; }
            });
        }

        // حجب console errors من الإعلانات
        const originalError = console.error;
        console.error = function(...args) {
            const message = args.join(' ').toLowerCase();
            for (let keyword of adKeywords) {
                if (message.includes(keyword)) {
                    return;
                }
            }
            originalError.apply(console, args);
        };

        // منع clicks على طبقات شفافة (overlay ads)
        document.addEventListener('mousedown', function(e) {
            if (e.target !== document.getElementById('stream') && 
                e.target.parentNode !== document.querySelector('.iframe-container')) {
                e.preventDefault();
                e.stopPropagation();
                e.stopImmediatePropagation();
                return false;
            }
        }, true);

        // حماية ضد click hijacking
        let lastClick = 0;
        document.addEventListener('click', function(e) {
            const now = Date.now();
            if (now - lastClick < 300) {
                e.preventDefault();
                e.stopPropagation();
                e.stopImmediatePropagation();
                return false;
            }
            lastClick = now;
        }, true);
    </script>
</body>
</html>